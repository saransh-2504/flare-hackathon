<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flare Autopilot - Secure Automation Platform</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles-v3.css">
</head>
<body>
    <div class="bg-animation">
        <div class="bg-grid"></div>
        <div class="orb orb1"></div>
        <div class="orb orb2"></div>
        <div class="orb orb3"></div>
    </div>

    <div class="container">
        <!-- Header -->
        <header class="glass-card header">
            <div class="logo-section">
                <div class="logo">‚ö° FLARE AUTOPILOT</div>
                <div class="security-status" id="securityStatus">
                    <div class="status-icon">üõ°Ô∏è</div>
                    <div class="status-text">
                        <h4>SYSTEM SECURE</h4>
                        <p>All systems operational</p>
                    </div>
                </div>
            </div>
            
            <div class="header-actions">
                <button class="btn btn-secondary" onclick="showInfo()">
                    <span>‚ÑπÔ∏è</span> Info
                </button>
                <button class="btn btn-primary" onclick="connectWallet()">
                    <span>üîó</span> Connect Wallet
                </button>
            </div>
        </header>

        <!-- Dashboard -->
        <div class="dashboard">
            <!-- Security Monitor -->
            <div class="glass-card security-panel">
                <div class="panel-header">
                    <h2 class="panel-title">üõ°Ô∏è Security Monitor</h2>
                    <button class="btn btn-secondary" onclick="refreshSecurity()">
                        <span>üîÑ</span> Refresh
                    </button>
                </div>

                <div class="threat-display" id="threatDisplay">
                    <div class="threat-indicator">‚úì</div>
                    <div class="threat-info">
                        <h3>Threat Level: SAFE</h3>
                        <p>No threats detected. All systems operational.</p>
                    </div>
                </div>

                <div class="sources-grid">
                    <div class="source-card">
                        <div class="source-header">
                            <span class="source-name">CertiK</span>
                            <span class="source-status"></span>
                        </div>
                        <div class="source-detail">Security monitoring active</div>
                    </div>
                    <div class="source-card">
                        <div class="source-header">
                            <span class="source-name">PeckShield</span>
                            <span class="source-status"></span>
                        </div>
                        <div class="source-detail">Threat detection active</div>
                    </div>
                    <div class="source-card">
                        <div class="source-header">
                            <span class="source-name">FTSO Monitor</span>
                            <span class="source-status"></span>
                        </div>
                        <div class="source-detail">Price anomaly detection</div>
                    </div>
                    <div class="source-card">
                        <div class="source-header">
                            <span class="source-name">FDC Verifier</span>
                            <span class="source-status"></span>
                        </div>
                        <div class="source-detail">Event verification active</div>
                    </div>
                </div>

                <button class="btn btn-danger" style="width: 100%;" onclick="testCircuitBreaker()">
                    <span>üö®</span> Test Circuit Breaker
                </button>
            </div>

            <!-- Stats -->
            <div class="stats-grid">
                <div class="glass-card stat-card">
                    <div class="stat-icon">üöÄ</div>
                    <div class="stat-value" id="activeStrategies">0</div>
                    <div class="stat-label">Active Strategies</div>
                </div>
                <div class="glass-card stat-card">
                    <div class="stat-icon">üõ°Ô∏è</div>
                    <div class="stat-value" id="protectedStrategies">0</div>
                    <div class="stat-label">Protected</div>
                </div>
                <div class="glass-card stat-card">
                    <div class="stat-icon">üí∞</div>
                    <div class="stat-value" id="gasSaved">$0</div>
                    <div class="stat-label">Gas Saved</div>
                </div>
                <div class="glass-card stat-card">
                    <div class="stat-icon">‚ö°</div>
                    <div class="stat-value" id="executions">0</div>
                    <div class="stat-label">Executions</div>
                </div>
            </div>
        </div>

        <!-- Tabs -->
        <div class="tabs">
            <button class="tab active" onclick="switchTab('create', event)">
                <span>‚ú®</span> Create Strategy
            </button>
            <button class="tab" onclick="switchTab('strategies', event)">
                <span>üìã</span> My Strategies
            </button>
            <button class="tab" onclick="switchTab('security', event)">
                <span>üõ°Ô∏è</span> Security Settings
            </button>
            <button class="tab" onclick="window.location.href='api-docs.html'">
                <span>üîå</span> API & Integration
            </button>
        </div>

        <!-- Tab: Create Strategy -->
        <div id="createTab" class="tab-content active">
            <div class="glass-card security-panel">
                <h2 class="panel-title">‚ú® Create Automation Strategy</h2>
                <form onsubmit="createStrategy(event)">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Trigger Type</label>
                            <select id="triggerType" required>
                                <option value="price">üìä Price Movement (FTSO)</option>
                                <option value="event">üåç Real-World Event (FDC)</option>
                                <option value="time">‚è∞ Time-Based</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Asset / Event</label>
                            <input type="text" id="asset" placeholder="e.g., BTC, GitHub repo" required>
                        </div>
                        <div class="form-group">
                            <label>Condition</label>
                            <input type="text" id="condition" placeholder="e.g., Price < $50,000" required>
                        </div>
                        <div class="form-group">
                            <label>Action</label>
                            <select id="action" required>
                                <option value="mint">ü™ô Mint FAssets</option>
                                <option value="swap">üîÑ Swap Tokens</option>
                                <option value="transfer">üí∏ Transfer</option>
                                <option value="redeem">üéÅ Redeem FAssets</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Amount (USD)</label>
                            <input type="number" id="amount" placeholder="100" required>
                        </div>
                        <div class="form-group">
                            <label>Safety Vault Address</label>
                            <input type="text" id="safetyVault" placeholder="0x... (for emergency transfers)">
                        </div>
                    </div>
                    
                    <div class="checkbox-wrapper">
                        <input type="checkbox" id="enableProtection" checked>
                        <label for="enableProtection" class="checkbox-label">
                            <strong>üõ°Ô∏è Enable Security Firewall Protection</strong>
                            <small>Automatically pause this strategy if threats are detected via FDC/FTSO monitoring</small>
                        </label>
                    </div>
                    
                    <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: 20px; padding: 18px; font-size: 1.1em;">
                        <span>‚ú®</span> Create Protected Strategy
                    </button>
                </form>
            </div>
        </div>

        <!-- Tab: My Strategies -->
        <div id="strategiesTab" class="tab-content">
            <div class="strategies-grid" id="strategiesList">
                <!-- Strategies will be dynamically added -->
            </div>
        </div>

        <!-- Tab: Security Settings -->
        <div id="securityTab" class="tab-content">
            <div class="glass-card security-panel">
                <h2 class="panel-title">üõ°Ô∏è Security Settings</h2>
                <div class="form-group">
                    <label>Price Anomaly Threshold (%)</label>
                    <input type="number" id="priceThreshold" value="20" min="1" max="100">
                    <p style="color: var(--text-muted); font-size: 0.9em; margin-top: 8px;">
                        Trigger alert when price changes by this percentage
                    </p>
                </div>
                <div class="form-group">
                    <label>Auto Circuit Breaker Threshold</label>
                    <input type="number" id="circuitThreshold" value="3" min="1" max="10">
                    <p style="color: var(--text-muted); font-size: 0.9em; margin-top: 8px;">
                        Automatically pause all strategies after this many threats
                    </p>
                </div>
                <div class="form-group">
                    <label>Emergency Vault Address</label>
                    <input type="text" id="emergencyVault" placeholder="0x...">
                    <p style="color: var(--text-muted); font-size: 0.9em; margin-top: 8px;">
                        Funds will be transferred here in case of emergency
                    </p>
                </div>
                <button class="btn btn-primary" style="width: 100%;" onclick="saveSecuritySettings()">
                    <span>üíæ</span> Save Settings
                </button>
            </div>
        </div>
    </div>

    <script src="config.js"></script>
    <script src="app-v2.js"></script>
</body>
</html>
